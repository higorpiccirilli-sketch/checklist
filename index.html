<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>‚úÖ Confer√™ncia de Cadastro de Produto ‚Äî Dark</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0b0f14; --elev:#121821; --muted:#1a2230; --text:#e6edf3; --sub:#9fb0c3; --acc:#4ba3ff; --ok:#22c55e; --warn:#f59e0b; --danger:#ef4444; --ring:#4ba3ff33;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,'Helvetica Neue',Arial,'Noto Sans',sans-serif;background:linear-gradient(180deg,#0b0f14,#0c1117);color:var(--text)}
    .container{max-width:980px;margin:40px auto;padding:24px}
    .card{background:linear-gradient(180deg,#0e141b,#0b1118);border:1px solid #1f2a3a;border-radius:16px;box-shadow:0 10px 30px #00000055}
    .header{display:flex;gap:16px;align-items:center;justify-content:space-between;padding:20px 24px;border-bottom:1px solid #1d2736}
    .title{display:flex;gap:12px;align-items:center;font-weight:700}
    .title .badge{font-size:12px;color:#c8d6e5;background:#1a2230;border:1px solid #223044;padding:4px 8px;border-radius:999px}
    .controls{display:flex;flex-wrap:wrap;gap:8px}
    .btn{appearance:none;border:1px solid #263245;background:#121a24;color:var(--text);padding:10px 12px;border-radius:12px;cursor:pointer;font-weight:600;transition:transform .08s ease, box-shadow .2s}
    .btn:hover{box-shadow:0 0 0 3px var(--ring)}
    .btn:active{transform:translateY(1px)}
    .btn.primary{background:linear-gradient(180deg,#0f2032,#0d1a28);border-color:#284264}
    .btn.ok{border-color:#214d34;background:#0e1c14}
    .btn.warn{border-color:#4a3b17;background:#1a1408}
    .btn.danger{border-color:#5b2323;background:#1a0e0e}
    .btn.icon{display:flex;align-items:center;gap:8px}

    .toolbar{display:grid;grid-template-columns:repeat(4,1fr) auto;gap:12px;align-items:end;padding:16px 24px;border-bottom:1px solid #1d2736}
    .field{display:flex;flex-direction:column;gap:6px;background:#0e151e;border:1px solid #223044;border-radius:12px;padding:10px}
    .field label{font-size:12px;color:var(--sub)}
    .field input[type="text"]{background:transparent;border:none;outline:none;color:var(--text);font-weight:600}
    .select{appearance:none;background:#0e151e;border:1px solid #223044;color:var(--text);padding:10px 12px;border-radius:12px}

    .progress{padding:16px 24px;display:flex;gap:16px;align-items:center}
    .bar{flex:1;height:10px;background:#111827;border:1px solid #1f2a3a;border-radius:999px;overflow:hidden}
    .bar > span{display:block;height:100%;width:0%;background:linear-gradient(90deg,var(--acc),#6ad1ff)}
    .meter{min-width:160px;text-align:right;color:var(--sub);font-size:14px}

    .list{padding:8px 12px 18px}
    .item{display:grid;grid-template-columns:28px 1fr auto;gap:12px;align-items:center;padding:12px 10px;margin:8px 0;border-radius:12px;background:linear-gradient(180deg,#0e141c,#0c1219);border:1px solid #1e293b}
    .item:hover{box-shadow:0 0 0 3px #4ba3ff22}
    .check{width:20px;height:20px;border:2px solid #355070;border-radius:6px;display:inline-grid;place-items:center;cursor:pointer;transition:all .15s;background:#0c1219}
    .check.done{border-color:#2f7d4b;background:#102217}
    .check svg{opacity:0;transition:opacity .15s}
    .check.done svg{opacity:1}
    .text{outline:none}
    .text[contenteditable="true"]{padding:6px;border-radius:8px}
    .text:focus{background:#0f1621;box-shadow:0 0 0 2px var(--ring)}
    .pill{font-size:12px;color:#9fb0c3;background:#131c28;border:1px solid #1f2a3a;border-radius:999px;padding:6px 10px;margin-right:8px}
    .actions{display:flex;gap:6px}
    .muted{color:var(--sub)}
    .ghost{opacity:.65}

    .footer{display:flex;justify-content:space-between;align-items:center;padding:16px 24px;border-top:1px solid #1d2736;color:var(--sub);font-size:13px}

    @media (max-width:820px){
      .toolbar{grid-template-columns:1fr 1fr}
    }

    @media (max-width:560px){
      .item{grid-template-columns:28px 1fr}
      .actions{grid-column:1/-1}
      .meter{min-width:120px}
    }

    /* Print-friendly */
    @media print{
      .btn, .footer{display:none !important}
      body{background:#fff;color:#000}
      .card{background:#fff;border:1px solid #ccc;box-shadow:none}
      .item{background:#fff;border-color:#ccc}
      .check{border-color:#555}
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="card" id="app">
      <div class="header">
        <div class="title">
          <span style="font-size:22px">‚úÖ Confer√™ncia de Cadastro de Produto</span>
          <span class="badge">Dark ‚Ä¢ Offline ‚Ä¢ Salva autom√°tico</span>
        </div>
        <div class="controls">
          <button class="btn ok icon" id="btnClearDone" title="Remover conclu√≠dos"><span>üßπ</span>Limpar conclu√≠dos</button>
          <button class="btn primary icon" id="btnExport" title="Exportar backup (JSON)"><span>üì§</span>Exportar</button>
          <label class="btn icon" title="Importar backup (JSON)" for="fileImport"><span>üì•</span>Importar</label>
          <input id="fileImport" type="file" accept="application/json" hidden />
        </div>
      </div>

      <!-- Dados do produto (vers√£o 1: manual, sem valida√ß√£o) -->
      <div class="toolbar" id="productForm">
        <div class="field"><label>üè∑Ô∏è SKU</label><input id="fSku" type="text" placeholder="Ex.: P-1234" /></div>
        <div class="field"><label>üìù Descri√ß√£o</label><input id="fDesc" type="text" placeholder="Nome do produto" /></div>
        <div class="field"><label>üì¶ NCM</label><input id="fNcm" type="text" placeholder="Ex.: 2309.90.10" /></div>
        <div class="field"><label>üìá EAN/GTIN</label><input id="fGtin" type="text" placeholder="Ex.: 7890000000000" /></div>
        <div style="display:flex;gap:8px;justify-content:flex-end">
          <button class="btn" id="btnClearForm" title="Limpar campos">Limpar campos</button>
        </div>
      </div>

      <div class="progress">
        <div class="bar" aria-label="Progresso"><span id="barFill"></span></div>
        <div class="meter"><span id="countDone">0</span>/<span id="countTotal">0</span> ‚Ä¢ <span id="pct">0%</span></div>
      </div>

      <div class="list" id="list"></div>

      <div class="footer">
        <div><span class="ghost">Dica:</span> Preencha os campos do produto e marque cada confer√™ncia. Tudo salva autom√°tico no navegador (localStorage).</div>
        <div>Feito com üñ§ ‚Äî vers√£o <strong>2.0 (Cadastro)</strong></div>
      </div>
    </div>
  </div>

  <svg width="0" height="0" style="position:absolute">
    <symbol id="checkmark" viewBox="0 0 24 24"><path fill="currentColor" d="M20.285 6.709a1 1 0 0 1 0 1.414l-9.192 9.192a1 1 0 0 1-1.414 0L3.715 11.55a1 1 0 1 1 1.414-1.414l5.243 5.243 8.485-8.485a1 1 0 0 1 1.428-.185z"/></symbol>
  </svg>

  <script>
    (function(){
      const $ = (q,el=document)=>el.querySelector(q);
      const $$ = (q,el=document)=>Array.from(el.querySelectorAll(q));
      const STORAGE_KEY = 'checklist_v2_cadastro';
      const listEl = $('#list');
      const barFill = $('#barFill');
      const countDone = $('#countDone');
      const countTotal = $('#countTotal');
      const pct = $('#pct');
      const btnExport = $('#btnExport');
      const btnClearDone = $('#btnClearDone');
      const fileImport = $('#fileImport');

      // Form fields
      const fSku = $('#fSku');
      const fDesc = $('#fDesc');
      const fNcm = $('#fNcm');
      const fGtin = $('#fGtin');
      const btnClearForm = $('#btnClearForm');

      /** Data **/
      let state = load() || seed();

      function uid(){return Math.random().toString(36).slice(2,9)}

      function seed(){
        return {
          form:{sku:'', desc:'', ncm:'', gtin:''},
          items:[
            {id:uid(), text:'Conferir SKU preenchido e padronizado', done:false, tag:'Obrigat√≥rio'},
            {id:uid(), text:'Conferir DESCRI√á√ÉO clara e no padr√£o interno', done:false, tag:'Obrigat√≥rio'},
            {id:uid(), text:'Conferir NCM compat√≠vel com o produto', done:false, tag:'Obrigat√≥rio'},
            {id:uid(), text:'Conferir EAN/GTIN v√°lido (c√≥digo de barras)', done:false, tag:'Obrigat√≥rio'}
          ]
        };
      }

      function save(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(state)); }
      function load(){ try{ return JSON.parse(localStorage.getItem(STORAGE_KEY)||''); }catch(e){ return null; } }

      // Bind form
      function applyForm(){
        fSku.value = state.form.sku||'';
        fDesc.value = state.form.desc||'';
        fNcm.value = state.form.ncm||'';
        fGtin.value = state.form.gtin||'';
      }
      function attachFormEvents(){
        [fSku,fDesc,fNcm,fGtin].forEach((inp)=>{
          inp.addEventListener('input', ()=>{
            state.form = {sku:fSku.value.trim(), desc:fDesc.value.trim(), ncm:fNcm.value.trim(), gtin:fGtin.value.trim()};
            save();
          });
        });
        btnClearForm.addEventListener('click', ()=>{
          fSku.value=fDesc.value=fNcm.value=fGtin.value='';
          state.form = {sku:'',desc:'',ncm:'',gtin:''};
          save();
        });
      }

      /** Render checklist **/
      function render(){
        listEl.innerHTML = '';
        for(const it of state.items){
          const row = document.createElement('div');
          row.className = 'item';
          row.dataset.id = it.id;
          row.innerHTML = `
            <div class="check ${it.done?'done':''}" role="checkbox" aria-checked="${it.done}" tabindex="0">
              <svg width="16" height="16"><use href="#checkmark"/></svg>
            </div>
            <div class="text" contenteditable="true">${escapeHtml(it.text)}</div>
            <div class="actions">
              ${it.tag?`<span class="pill">${escapeHtml(it.tag)}</span>`:''}
              <button class="btn danger" data-action="del">Excluir</button>
            </div>`;
          listEl.appendChild(row);
        }
        updateProgress();
      }

      function updateProgress(){
        const total = state.items.length;
        const done = state.items.filter(i=>i.done).length;
        const p = total ? Math.round((done/total)*100) : 0;
        countTotal.textContent = total;
        countDone.textContent = done;
        pct.textContent = p + '%';
        barFill.style.width = p + '%';
      }

      function escapeHtml(s){
        return String(s).replace(/[&<>"]|'/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;'}[m]||m));
      }

      /** Events **/
      listEl.addEventListener('click', e=>{
        const row = e.target.closest('.item');
        if(!row) return;
        const id = row.dataset.id;
        if(e.target.closest('.check')){
          const it = state.items.find(i=>i.id===id); if(!it) return;
          it.done = !it.done; save(); render();
        }
        if(e.target.matches('[data-action="del"]')){
          state.items = state.items.filter(i=>i.id!==id); save(); render();
        }
      });

      listEl.addEventListener('keydown', e=>{
        if(e.key==='Enter' && e.target.classList.contains('text')){
          e.preventDefault(); e.target.blur();
        }
      });

      listEl.addEventListener('blur', e=>{
        if(e.target.classList.contains('text')){
          const row = e.target.closest('.item');
          const it = state.items.find(i=>i.id===row.dataset.id);
          if(it){ it.text = e.target.textContent.trim(); save(); updateProgress(); }
        }
      }, true);

      // Export/Import backup
      btnExport.addEventListener('click', ()=>{
        const blob = new Blob([JSON.stringify(state,null,2)], {type:'application/json'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        const sku = state.form.sku?`_${state.form.sku}`:'';
        a.href = url; a.download = `cadastro_checklist${sku}.json`; a.click();
        URL.revokeObjectURL(url);
      });

      btnClearDone.addEventListener('click', ()=>{
        state.items = state.items.filter(i=>!i.done); save(); render();
      });

      fileImport.addEventListener('change', async (e)=>{
        const f = e.target.files[0]; if(!f) return;
        const txt = await f.text();
        try{
          const data = JSON.parse(txt);
          if(data && Array.isArray(data.items) && data.form){
            state = {
              form:{
                sku: String(data.form.sku||''),
                desc: String(data.form.desc||''),
                ncm: String(data.form.ncm||''),
                gtin: String(data.form.gtin||'')
              },
              items: data.items.filter(x=>x && typeof x.text==='string').map(x=>({
                id: x.id || uid(), text: String(x.text), done: !!x.done, tag: x.tag?String(x.tag):''
              }))
            };
            save(); applyForm(); render();
          } else if (Array.isArray(data)) { // retrocompat√≠vel com v1 (lista simples)
            state.items = data.filter(x=>x && typeof x.text==='string').map(x=>({
              id: x.id || uid(), text: String(x.text), done: !!x.done, tag: x.tag?String(x.tag):''
            }));
            save(); render();
          } else { alert('Arquivo inv√°lido.'); }
        }catch(err){ alert('JSON inv√°lido.'); }
        fileImport.value='';
      });

      // Init
      applyForm();
      attachFormEvents();
      render();
    })();
  </script>
</body>
</html>
