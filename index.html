<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>âœ… Checklist Interativo â€” Dark</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0b0f14; --elev:#121821; --muted:#1a2230; --text:#e6edf3; --sub:#9fb0c3; --acc:#4ba3ff; --ok:#22c55e; --warn:#f59e0b; --danger:#ef4444; --ring:#4ba3ff33;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,'Helvetica Neue',Arial,'Noto Sans',sans-serif;background:linear-gradient(180deg,#0b0f14,#0c1117);color:var(--text)}
    .container{max-width:900px;margin:40px auto;padding:24px}
    .card{background:linear-gradient(180deg,#0e141b,#0b1118);border:1px solid #1f2a3a;border-radius:16px;box-shadow:0 10px 30px #00000055}
    .header{display:flex;gap:16px;align-items:center;justify-content:space-between;padding:20px 24px;border-bottom:1px solid #1d2736}
    .title{display:flex;gap:12px;align-items:center;font-weight:700}
    .title .badge{font-size:12px;color:#c8d6e5;background:#1a2230;border:1px solid #223044;padding:4px 8px;border-radius:999px}
    .controls{display:flex;flex-wrap:wrap;gap:8px}
    .btn{appearance:none;border:1px solid #263245;background:#121a24;color:var(--text);padding:10px 12px;border-radius:12px;cursor:pointer;font-weight:600;transition:transform .08s ease, box-shadow .2s}
    .btn:hover{box-shadow:0 0 0 3px var(--ring)}
    .btn:active{transform:translateY(1px)}
    .btn.primary{background:linear-gradient(180deg,#0f2032,#0d1a28);border-color:#284264}
    .btn.ok{border-color:#214d34;background:#0e1c14}
    .btn.warn{border-color:#4a3b17;background:#1a1408}
    .btn.danger{border-color:#5b2323;background:#1a0e0e}
    .btn.icon{display:flex;align-items:center;gap:8px}

    .toolbar{display:flex;gap:12px;flex-wrap:wrap;padding:16px 24px;border-bottom:1px solid #1d2736}
    .field{display:flex;gap:8px;align-items:center;background:#0e151e;border:1px solid #223044;border-radius:12px;padding:8px 10px}
    .field input[type="text"]{background:transparent;border:none;outline:none;color:var(--text);min-width:260px}
    .select{appearance:none;background:#0e151e;border:1px solid #223044;color:var(--text);padding:10px 12px;border-radius:12px}

    .progress{padding:16px 24px;display:flex;gap:16px;align-items:center}
    .bar{flex:1;height:10px;background:#111827;border:1px solid #1f2a3a;border-radius:999px;overflow:hidden}
    .bar > span{display:block;height:100%;width:0%;background:linear-gradient(90deg,var(--acc),#6ad1ff)}
    .meter{min-width:140px;text-align:right;color:var(--sub);font-size:14px}

    .list{padding:8px 12px 18px}
    .item{display:grid;grid-template-columns:28px 1fr auto;gap:12px;align-items:center;padding:12px 10px;margin:8px 0;border-radius:12px;background:linear-gradient(180deg,#0e141c,#0c1219);border:1px solid #1e293b}
    .item:hover{box-shadow:0 0 0 3px #4ba3ff22}
    .check{width:20px;height:20px;border:2px solid #355070;border-radius:6px;display:inline-grid;place-items:center;cursor:pointer;transition:all .15s;background:#0c1219}
    .check.done{border-color:#2f7d4b;background:#102217}
    .check svg{opacity:0;transition:opacity .15s}
    .check.done svg{opacity:1}
    .text{outline:none}
    .text[contenteditable="true"]{padding:6px;border-radius:8px}
    .text:focus{background:#0f1621;box-shadow:0 0 0 2px var(--ring)}
    .pill{font-size:12px;color:#9fb0c3;background:#131c28;border:1px solid #1f2a3a;border-radius:999px;padding:6px 10px;margin-right:8px}
    .actions{display:flex;gap:6px}
    .muted{color:var(--sub)}
    .ghost{opacity:.65}

    .footer{display:flex;justify-content:space-between;align-items:center;padding:16px 24px;border-top:1px solid #1d2736;color:var(--sub);font-size:13px}
    .link{color:#9ac5ff;text-decoration:none;border-bottom:1px dashed #3b74b6}

    @media (max-width:560px){
      .item{grid-template-columns:28px 1fr}
      .actions{grid-column:1/-1}
      .meter{min-width:90px}
    }

    /* Print-friendly */
    @media print{
      .btn, .toolbar, .footer{display:none !important}
      body{background:#fff;color:#000}
      .card{background:#fff;border:1px solid #ccc;box-shadow:none}
      .item{background:#fff;border-color:#ccc}
      .check{border-color:#555}
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="card" id="app">
      <div class="header">
        <div class="title">
          <span style="font-size:22px">âœ… Checklist Interativo</span>
          <span class="badge">Dark â€¢ Offline â€¢ Salva automÃ¡tico</span>
        </div>
        <div class="controls">
          <button class="btn ok icon" id="btnClearDone" title="Remover conclUÃ­dos"><span>ðŸ§¹</span>Limpar concluÃ­dos</button>
          <button class="btn primary icon" id="btnExport" title="Exportar JSON"><span>ðŸ“¤</span>Exportar</button>
          <label class="btn icon" title="Importar JSON" for="fileImport"><span>ðŸ“¥</span>Importar</label>
          <input id="fileImport" type="file" accept="application/json" hidden />
        </div>
      </div>

      <div class="toolbar">
        <div class="field" style="flex:1">
          <span>âž•</span>
          <input id="newText" type="text" placeholder="Adicionar itemâ€¦ (Enter adiciona)" />
        </div>
        <select id="filter" class="select" title="Filtrar itens">
          <option value="all">Mostrar: Todos</option>
          <option value="todo">Mostrar: Pendentes</option>
          <option value="done">Mostrar: ConcluÃ­dos</option>
        </select>
      </div>

      <div class="progress">
        <div class="bar" aria-label="Progresso"><span id="barFill"></span></div>
        <div class="meter"><span id="countDone">0</span>/<span id="countTotal">0</span> â€¢ <span id="pct">0%</span></div>
      </div>

      <div class="list" id="list">
        <!-- Itens padrÃ£o (editÃ¡veis) â†’ se existir storage, serÃ£o substituÃ­dos -->
        <div class="item" data-id="seed-1">
          <div class="check" role="checkbox" aria-checked="false" tabindex="0"></div>
          <div class="text" contenteditable="true">Definir objetivo do painel</div>
          <div class="actions">
            <span class="pill">Planejamento</span>
            <button class="btn danger" data-action="del">Excluir</button>
          </div>
        </div>
        <div class="item" data-id="seed-2">
          <div class="check" role="checkbox" aria-checked="false" tabindex="0"></div>
          <div class="text" contenteditable="true">Coletar dados de origem (CSV/Planilha)</div>
          <div class="actions">
            <span class="pill">Dados</span>
            <button class="btn danger" data-action="del">Excluir</button>
          </div>
        </div>
        <div class="item" data-id="seed-3">
          <div class="check" role="checkbox" aria-checked="false" tabindex="0"></div>
          <div class="text" contenteditable="true">Validar consistÃªncias e regras</div>
          <div class="actions">
            <span class="pill">Qualidade</span>
            <button class="btn danger" data-action="del">Excluir</button>
          </div>
        </div>
      </div>

      <div class="footer">
        <div><span class="ghost">Dica:</span> Duplo clique no texto para editar. Tudo salva automÃ¡tico (localStorage).</div>
        <div>Feito com <span aria-hidden>ðŸ–¤</span> â€” versÃ£o <strong>1.0</strong></div>
      </div>
    </div>
  </div>

  <svg width="0" height="0" style="position:absolute">
    <symbol id="checkmark" viewBox="0 0 24 24"><path fill="currentColor" d="M20.285 6.709a1 1 0 0 1 0 1.414l-9.192 9.192a1 1 0 0 1-1.414 0L3.715 11.55a1 1 0 1 1 1.414-1.414l5.243 5.243 8.485-8.485a1 1 0 0 1 1.428-.185z"/></symbol>
  </svg>

  <script>
    (function(){
      const $ = (q,el=document)=>el.querySelector(q);
      const $$ = (q,el=document)=>Array.from(el.querySelectorAll(q));
      const STORAGE_KEY = 'checklist_v1';
      const listEl = $('#list');
      const newText = $('#newText');
      const filter = $('#filter');
      const barFill = $('#barFill');
      const countDone = $('#countDone');
      const countTotal = $('#countTotal');
      const pct = $('#pct');
      const btnExport = $('#btnExport');
      const btnClearDone = $('#btnClearDone');
      const fileImport = $('#fileImport');

      /** Data **/
      let items = load() || domSeed();

      function uid(){return Math.random().toString(36).slice(2,9)}

      function domSeed(){
        return $$('.item', listEl).map(el=>({
          id: el.dataset.id || uid(),
          text: $('.text', el).textContent.trim(),
          done: $('.check', el).classList.contains('done'),
          tag: ($('.pill', el)?.textContent||'')
        }));
      }

      function save(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(items)); }
      function load(){ try{ return JSON.parse(localStorage.getItem(STORAGE_KEY)||''); }catch(e){ return null; } }

      /** Render **/
      function render(){
        listEl.innerHTML = '';
        let visible = items;
        if(filter.value==='todo') visible = items.filter(i=>!i.done);
        if(filter.value==='done') visible = items.filter(i=>i.done);

        for(const it of visible){
          const row = document.createElement('div');
          row.className = 'item';
          row.dataset.id = it.id;
          row.innerHTML = `
            <div class="check ${it.done?'done':''}" role="checkbox" aria-checked="${it.done}" tabindex="0">
              <svg width="16" height="16"><use href="#checkmark"/></svg>
            </div>
            <div class="text" contenteditable="true">${escapeHtml(it.text)}</div>
            <div class="actions">
              ${it.tag?`<span class="pill">${escapeHtml(it.tag)}</span>`:''}
              <button class="btn danger" data-action="del">Excluir</button>
            </div>`;
          listEl.appendChild(row);
        }
        updateProgress();
      }

      function updateProgress(){
        const total = items.length;
        const done = items.filter(i=>i.done).length;
        const p = total ? Math.round((done/total)*100) : 0;
        countTotal.textContent = total;
        countDone.textContent = done;
        pct.textContent = p + '%';
        barFill.style.width = p + '%';
      }

      function escapeHtml(s){
        return s.replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;'}[m]));
      }

      /** Events **/
      listEl.addEventListener('click', e=>{
        const row = e.target.closest('.item');
        if(!row) return;
        const id = row.dataset.id;
        if(e.target.closest('.check')){
          const it = items.find(i=>i.id===id); if(!it) return;
          it.done = !it.done; save(); render();
        }
        if(e.target.matches('[data-action="del"]')){
          items = items.filter(i=>i.id!==id); save(); render();
        }
      });

      listEl.addEventListener('keydown', e=>{
        if(e.key==='Enter' && e.target.classList.contains('text')){
          e.preventDefault(); e.target.blur();
        }
      });

      listEl.addEventListener('blur', e=>{
        if(e.target.classList.contains('text')){
          const row = e.target.closest('.item');
          const it = items.find(i=>i.id===row.dataset.id);
          if(it){ it.text = e.target.textContent.trim(); save(); updateProgress(); }
        }
      }, true);

      newText.addEventListener('keydown', e=>{
        if(e.key==='Enter') addItem();
      });

      function addItem(){
        const text = newText.value.trim(); if(!text) return;
        items.unshift({id:uid(), text, done:false, tag:''});
        newText.value=''; save(); render();
      }

      filter.addEventListener('change', render);

      btnExport.addEventListener('click', ()=>{
        const blob = new Blob([JSON.stringify(items,null,2)], {type:'application/json'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url; a.download = 'checklist.json'; a.click();
        URL.revokeObjectURL(url);
      });

      btnClearDone.addEventListener('click', ()=>{
        items = items.filter(i=>!i.done); save(); render();
      });

      fileImport.addEventListener('change', async (e)=>{
        const f = e.target.files[0]; if(!f) return;
        const txt = await f.text();
        try{
          const data = JSON.parse(txt);
          if(Array.isArray(data)){
            items = data.filter(x=>x && typeof x.text==='string').map(x=>({
              id: x.id || uid(), text: String(x.text), done: !!x.done, tag: x.tag?String(x.tag):''
            }));
            save(); render();
          }else{ alert('Arquivo invÃ¡lido.'); }
        }catch(err){ alert('JSON invÃ¡lido.'); }
        fileImport.value='';
      });

      render();
    })();
  </script>
</body>
</html>
